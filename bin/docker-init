#!/bin/bash

# 
# TODO: figure out how to turn this into a stack template
#

if [ "$#" -ne 0 ]; then
  echo "usage: docker-init"
  echo ""
  exit 1
fi


alpine-stack init

LOCAL_INSTALL_ROOT=$(alpine-stack path | grep "local-install-root" | cut -f2 -d' ' | sed -e 's/^\/data\///' | tr -d '[[:space:]]')

#
# Generate the Dockerfile
#
cat << EOF > Dockerfile
FROM alpine:latest

ADD $LOCAL_INSTALL_ROOT/bin /main

RUN apk update \
      && apk add gmp

CMD /main/$PACKAGE_NAME-app
EOF
